<ng-template #dialogContentTemplate>
  <div id="dialog-content">
    <div class="row">
      <div id="dialog-container">
        <div id="dialog-header">
          <h2 mat-dialog-title id="dialog-title">Save Permissions</h2>
          <h4 id="dialog-subtitle">Are you sure you want to save the permissions that you edited?</h4>
        </div>
        <div id="button-container">
          <button mat-button mat-dialog-close id="save-button" (click)="saveChanges()">Save</button>
          <button mat-button mat-dialog-close id="cancel-button" (click)="onBack()">Back</button>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #dialogCancelTemplate>
  <div id="dialog-content">
    <div class="row">
      <div id="dialog-container">
        <div id="dialog-header-cancel">
          <h2 mat-dialog-title id="dialog-title-cancel">Discard unsaved changes?</h2>
        </div>
        <div id="button-container">
          <button mat-button mat-dialog-close id="save-button" (click)="discardChanges()">Discard</button>
          <button mat-button mat-dialog-close id="cancel-button" (click)="onBack()">Back</button>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<div class="row">
  <div class="col-12" id="button-save-container">
    <button mat-button id="savechangesbtn" (click)="openDialog()" class="btn btn-primary rounded-pill">Save
      Changes</button>
  </div>
  <div class="table-responsive">
    <table class="table" id="mattable">
      <thead>
        <tr>
          <th scope="col" id="tableheader">
            Permissions
          </th>
          <th scope="col" *ngFor="let p of roles" id="tableheader">
            {{ p.description }}
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th scope="row" id="subheader">
            Charts
          </th>
          <th scope="row" *ngFor="let r of roles" id="allsubheader">
            <mat-checkbox color="primary" [(ngModel)]="allCheckboxesState[r.description]"
              (change)="toggleAllCheckboxes(r.description)">
              All
            </mat-checkbox>
          </th>
        </tr>
        <tr *ngFor="let n of chartPermissions">
          <th scope="row" id="permissions">
            {{ n.permission }}
          </th>
          <th *ngFor="let r of roles">
            <mat-checkbox color="primary" [(ngModel)]="checkboxStates[r.description + n.permission]"
              (change)="onChangeRoleAccess($event, r.description, n.permission, n.grouping)">
            </mat-checkbox>
          </th>
        </tr>

        <tr>
          <th scope="row" id="subheader">
            Employee Data
          </th>
          <th scope="row" *ngFor="let r of roles" id="allsubheader">
            <mat-checkbox color="primary" [(ngModel)]="allEmployeeDataCheckboxesState[r.description]"
              (change)="toggleAllEmployeeDataCheckboxes(r.description)">
              All
            </mat-checkbox>
          </th>
        </tr>
        <tr *ngFor="let n of employeePermissions">
          <th scope="row" id="permissions">
            {{n.permission}}
          </th>
          <th *ngFor="let r of roles">
            <mat-checkbox color="primary" [(ngModel)]="checkboxStatesEmployeePermissions[r.description + n.permission]"
              (change)="onChangeRoleAccess($event, r.description, n.permission, n.grouping)">
            </mat-checkbox>
          </th>
        </tr>
      </tbody>
    </table>
  </div>
</div>