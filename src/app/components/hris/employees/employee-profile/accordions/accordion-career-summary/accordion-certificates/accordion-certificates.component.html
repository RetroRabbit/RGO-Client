<div class="col-12" id="accordion-container">
    <mat-accordion id="accordion" class="row">
        <mat-expansion-panel class="mt-3 rounded-3" (opened)="panelOpenState = true" (closed)="panelOpenState = false">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Certificates
                </mat-panel-title>
                <mat-panel-description *ngIf="certificateInformationProgress != 100" class="pe-0 pe-md-5">
                    <mat-icon class="mx-1">error</mat-icon><span class="d-none d-md-block d-lg-block">Missing
                        information</span>
                </mat-panel-description>
            </mat-expansion-panel-header>
            <form [formGroup]="certificateForm">
                <div class="row">
                    <div class="col-12 col-md-9 col-lg-10">
                        <div class="row">
                            <div class="col-12 row">
                                <div class="col-12 col-md-6 my-2">
                                    <mat-form-field appearance="outline" style="width: 100%;">
                                        <mat-label>Certificate Name</mat-label>
                                        <input type="text" matInput placeholder="Name of certificate"
                                            formControlName="CertificateName">
                                        <mat-error
                                            *ngIf="certificateForm.controls['CertificateName'].hasError('required')">
                                            Certificate name is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col-12 col-md-6 my-2 d-flex align-items-center">
                                    <mat-form-field appearance="outline" style="width: 100%;" class="flex-grow-1">
                                        <mat-label>Issuing Organization</mat-label>
                                        <input type="text" matInput placeholder="Issuing organization"
                                            formControlName="IssueOrganization">
                                        <mat-error
                                            *ngIf="certificateForm.controls['IssueOrganization'].hasError('required')">
                                            Issuing organization is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="col-12 row">
                                <div class="col-12 col-md-6 my-2">
                                    <mat-form-field appearance="outline" style="width: 100%;">
                                        <mat-label>Issue Date</mat-label>
                                        <input matInput [matDatepicker]="picker" placeholder="Issue date"
                                            formControlName="IssueDate">
                                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                        <mat-datepicker #picker></mat-datepicker>
                                        <mat-error *ngIf="certificateForm.controls['IssueDate'].hasError('required')">
                                            Issue date is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="col-6 d-md-flex">
                                <div class="d-flex align-items-start" id="document-name">
                                    <div class="row certificateFileName" *ngIf="certificateFileName">
                                       <span class="mt-3"> {{ certificateFileName }}</span>
                                    </div>
                                    <div class="ml-2"> 
                                        <button mat-button id="upload-document-button" class="py-4" (click)="uploadCertificateFile.click()">
                                            <mat-icon class="upload-document">save_alt</mat-icon>
                                            Upload Document
                                        </button>
                                    </div>
                                    <input type="file" #uploadCertificateFile (change)="onDocumentChange($event)" hidden accept=".pdf" />
                                </div>
                            </div>
                            
                            <p id="base64"></p>
                            <div class="col-12 col-md-6 my-2">
                                <div class="my-2">
                                    <div [ngClass]="screenWidth <= 767 ? '' : 'row'">
                                        <div class="col-12 row d-flex justify-content-center align-content-center"
                                            [hidden]="!editCertificate" (click)="openFileInput()">
                                            <div class="col-12 row ms-1" *ngIf="certificatePDFName.length > 1">
                                                <div class="col-1 p-0">
                                                    <img id="pdf-icon" alt="pdf-icon"
                                                        src="../../../../../../assets/img/pdf-icon.svg">
                                                </div>
                                                <p class="col-11" id="recently-uploaded">{{certificatePDFName}}</p>
                                            </div>
                                            <div *ngIf="!editCertificate"
                                                class="col-12 rounded-5 bg-light d-flex justify-content-center align-content-center align-items-center ms-4">
                                                <div class="col-1" id="uploadfile">
                                                    <img src="../../../../assets/img/file_upload_grey.svg" alt="">
                                                </div>
                                                <div class="col-auto" id="uploadfile">
                                                    <h4 class="m-2">Add Another Certificate</h4>
                                                    <input id="fileUpload" hidden type="file"
                                                        [disabled]="!editCertificate" (change)="onFileSelected($event)"
                                                        accept=".pdf">
                                                </div>
                                            </div>
                                            <div *ngIf="editCertificate" style="background-color:#D7DFFF;"
                                                class="col-12 rounded-5 d-flex justify-content-center align-content-center align-items-center ms-4">
                                                <div class="col-1" id="uploadfile">
                                                    <img src="../../../../assets/img/file_upload.svg" alt="">
                                                </div>
                                                <div class="col-auto" id="uploadfile">
                                                    <h4 class="m-2" style="color: #0029C6;">Add Another Certificate</h4>
                                                    <input id="fileUpload" hidden type="file"
                                                        [disabled]="!editCertificate" (change)="onFileSelected($event)"
                                                        accept=".pdf">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-12 d-block d-md-none" id="edit-buttons">
                                <button *ngIf="editCertificate" mat-button id="save-button" type="submit"
                                    (click)="saveCertificateDetails()" class="col-12 mb-2">
                                    Save changes
                                </button>
                                <button *ngIf="editCertificate" mat-button id="cancel-button"
                                    (click)="cancelCertificateDetails()" class="col-12">
                                    Cancel
                                </button>
                            </div>
                            <div class="col-12 d-none d-md-flex" id="edit-buttons">
                                <button *ngIf="editCertificate" mat-button id="cancel-button"
                                    (click)="cancelCertificateDetails()">
                                    Cancel
                                </button>
                                <button *ngIf="editCertificate" mat-button id="save-button" type="submit"
                                    (click)="saveCertificateDetails()">
                                    Save changes
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-3 d-none d-md-flex mt-md-2 justify-content-end">
                        <button *ngIf="!editCertificate" mat-button id="edit-button-width"
                            (click)="editCertificateDetails()" [ngClass]="screenWidth <= 767 ? 'col-12' : ''">
                            <mat-icon>edit</mat-icon>Edit Details
                        </button>
                    </div>
                </div>
            </form>
        </mat-expansion-panel>
    </mat-accordion>
</div>