<!-- <app-loading-component *ngIf="isLoading"></app-loading-component> -->
<div class="container mt-4">
    <div class="w-75 py-3">
        <button mat-button class="btn" id="back-button" (click)="goToEmployees()"
            *ngIf="previousPage == '/employees' && showBackButtons">
            <mat-icon>arrow_back</mat-icon>
            <span>Back to Employees</span>
        </button>
        <button mat-button class="btn" id="back-button" (click)="goToDashboard()"
            *ngIf="previousPage == '/dashboard'  &&  showBackButtons">
            <mat-icon>arrow_back</mat-icon>
            <span>Back to Dashboard</span>
        </button>
    </div>
    <div id="profile-header" class="row p-2">
        <div class="col-2 mt-4">
            <div id="profile-image">
                <img [src]="usingSimpleProfile ? simpleEmployee?.photo : employeeProfile?.photo" alt="">
            </div>
        </div>
        <div class="col-md-8 offset-md-2 offset-lg-0 col-lg-10 mt-4">
            <div class="row mt-3">
                <div class="col-6 col-md-8" id="header-name">
                    <h1>{{usingSimpleProfile ? simpleEmployee?.name :employeeProfile?.name}} {{usingSimpleProfile ? simpleEmployee?.surname : employeeProfile?.surname}}</h1>
                </div>
                <div class="col-6 col-md-4" id="header-email">
                    <div class="row me-4">
                        <div class="col-auto">{{usingSimpleProfile ? simpleEmployee?.email : employeeProfile?.email}}</div>
                        <div class="col-1 mt-2" id="header-email-clip"><mat-icon>attachment</mat-icon></div>
                    </div>
                </div>
                <div class="col-12 my-2" id="header-role">
                    {{usingSimpleProfile ? simpleEmployee?.employeeType?.name :employeeProfile?.employeeType?.name}} | Level {{usingSimpleProfile ? simpleEmployee?.level :employeeProfile?.level}}
                </div>
                <div class="col-12 my-2" id="header-based"
                    *ngIf="employeePhysicalAddress != undefined && employeePhysicalAddress.city != ' ' && employeePhysicalAddress.city != ''">
                    Based in {{employeePhysicalAddress.city}}
                </div>
            </div>
        </div>
        <div class="col-12 col-lg-10 offset-lg-2 my-4">
            <div class="row" id="quick-info">
                <div class="col-3 mb-md-2">
                    <div class="row">
                        <div class="col-3" id="outer-icon-container">
                            <div id="icon-container">
                                <mat-icon>people_outline</mat-icon>
                            </div>
                        </div>
                        <div class="col-9 my-2">
                            <div id="header-label">Team Lead</div>
                            <div id="header-value" *ngIf="!usingSimpleProfile;else NonAdminTeamLead">
                                {{employeeTeamLead ? employeeTeamLead.name + ' ' + employeeTeamLead.surname : 'Not assigned'}}
                            </div>
                            <ng-template #NonAdminTeamLead>
                                {{simpleEmployee?.teamLeadName }}
                            </ng-template>
                        </div>
                    </div>
                </div>
                <div class="col-3 mb-md-2">
                    <div class="row">
                        <div class="col-3" id="outer-icon-container">
                            <div id="icon-container">
                                <mat-icon>card_membership</mat-icon>
                            </div>
                        </div>
                        <div class="col-9 my-2">
                            <div id="header-label">People Champion</div>
                            <div id="header-value" *ngIf="!usingSimpleProfile;else NonAdminPeopleChampion">
                                {{employeePeopleChampion ? employeePeopleChampion.name + ' ' + employeePeopleChampion.surname: 'Not assigned'}}
                            </div>
                            <ng-template #NonAdminPeopleChampion>
                                {{simpleEmployee?.peopleChampionName}}
                            </ng-template>
                        </div>
                    </div>
                </div>
                <div class="col-3 mb-md-2">
                    <div class="row">
                        <div class="col-3" id="outer-icon-container">
                            <div id="icon-container">
                                <mat-icon>business_center</mat-icon>
                            </div>
                        </div>
                        <div class="col-9 my-2">
                            <div id="header-label">Client Allocated</div>
                            <div id="header-value">
                                {{employeeClient?.name ?? 'Bench'}}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-3 mb-md-2">
                    <div class="row">
                        <div class="col-3" id="outer-icon-container">
                            <div id="icon-container">
                                <mat-icon>date_range</mat-icon>
                            </div>
                        </div>
                        <div class="col-9 my-2">
                            <div id="header-label">Start Date</div>
                            <div *ngIf="!usingSimpleProfile;else NonAdminEngagementDate" id="header-value">
                                {{ employeeProfile?.engagementDate| date:'d MMM yyyy' }}
                            </div>
                            <ng-template #NonAdminEngagementDate>
                                {{simpleEmployee?.engagementDate| date:'d MMM yyyy'}}
                            </ng-template>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="profile-completion" class="row my-4 p-2">
        <div class="col-12 mt-2" id="completion-header">
            <div class="row" id="completion-header-container">
                <div class="col-1">
                    <div id="outer-icon-container">
                        <div id="icon-container" class="me-0 pe-0">
                            <mat-icon>person_outline</mat-icon>
                        </div>
                    </div>
                </div>
                <div class="col-11 ps-0">
                    <h4 style="margin:0"> {{usingSimpleProfile ? simpleEmployee?.name :employeeProfile?.name}}'s profile progess </h4>
                </div>
            </div>
        </div>
        <div class="col-12 mt-3 px-4">
            <div class="row">
                <div class="col-12 mx-3">
                    <h3 id="progress-require-message">Add all required information to complete profile</h3>
                </div>
            </div>
        </div>
        <div class="col-11 px-4">
            <div class="row mx-3" id="accordion-progress">
                <div class="col-2 py-3" id="progress-stats"
                    style="background-color: {{ profileFormProgress === 100 ? '#d7dfff' : 'white' }}; color: {{ profileFormProgress === 100 ? '#0029c6' : 'grey' }}; border: {{ profileFormProgress === 100 ? '1px solid #0029c6' : '1px solid grey' }}">
                    <h5>Profile Details {{ profileFormProgress }}%</h5>
                </div>
                <div class="col-1 border" id="horizontal"></div>
                <div class="col-2 py-3" id="progress-stats"
                    style="background-color: {{ bankInformationProgress === 100 && bankStatus == 0 ? '#d7dfff' : 'white' }}; color: {{ bankInformationProgress === 100 && bankStatus == 0 ? '#0029c6' : 'grey' }}; border: {{ bankInformationProgress === 100 && bankStatus == 0 ? '1px solid #0029c6' : '1px solid grey' }}">
                    <h5>Bank Information {{bankInformationProgress}}%</h5>
                </div>
                <div class="col-1 border" id="horizontal"></div>
                <div class="col-2 py-3" id="progress-stats"
                    style="background-color: {{ documentFormProgress === 100 ? '#d7dfff' : 'white' }}; color: {{ documentFormProgress === 100 ? '#0029c6' : 'grey' }}; border: {{ documentFormProgress === 100 ? '1px solid #0029c6' : '1px solid grey' }}">
                    <h5>Documents {{documentFormProgress}}%</h5>
                </div>
            </div>
        </div>
        <div class="col-12 mt-3 px-4">
            <div class="row mx-2">
                <div class="col-auto pt-1" id="overall-text">
                    <h4>
                        {{overallFormProgress}}% Overall Completed
                    </h4>
                </div>
                <div class="col-10 pt-3" id="progress-container">
                    <mat-progress-bar mode="determinate" [value]=overallFormProgress
                        id="overall-progress-bar"></mat-progress-bar>
                </div>
            </div>
        </div>
    </div>

    <div id="profile-accordions">
        <div id="accordions-nav" class="row">
            <div class="col-4">
                <div id="nav-item-container" class="col-auto">
                    <div id="nav-item">
                        <div (click)="CaptureEvent($event)"
                            [ngClass]="selectedItem == 'Profile Details' ? 'active' : 'idle'">
                            Profile Details
                        </div>
                        <div *ngIf="selectedItem == 'Profile Details'" id="selected-line-box">
                            <div id="selected-line">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-4">
                <div id="nav-item-container" class="col-auto">
                    <div id="nav-item">
                        <div (click)="CaptureEvent($event)"
                            [ngClass]="selectedItem == 'Bank Information' ? 'active' : 'idle'">
                            Bank Information
                        </div>
                        <div *ngIf="selectedItem == 'Bank Information'" id="selected-line-box">
                            <div id="selected-line">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-4">
                <div id="nav-item-container" class="col-auto">
                    <div id="nav-item">
                        <div (click)="CaptureEvent($event)" [ngClass]="selectedItem == 'Documents' ? 'active' : 'idle'">
                            Documents
                        </div>
                        <div *ngIf="selectedItem == 'Documents'" id="selected-line-box">
                            <div id="selected-line">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="accordions-body`" class="row" *ngIf="employeeProfile">
            <app-accordion-profile [hidden]="selectedAccordion != 'Profile Details'" [employeeProfile]="{employeeProfile: employeeProfile, simpleEmployee: simpleEmployee}" (updateProfile)="updateProfileProgress($event)"></app-accordion-profile>
            <app-accordion-banking [hidden]="selectedAccordion != 'Bank Information'" [employeeProfile]="employeeProfile" (updateBanking)="updateBankingProgress($event)"></app-accordion-banking>
            <app-accordion-documents [hidden]="selectedAccordion != 'Documents'"[employeeProfile]="employeeProfile" (updateDocument)="updateDocumentProgress($event)"></app-accordion-documents>
        </div>
    </div>
</div>