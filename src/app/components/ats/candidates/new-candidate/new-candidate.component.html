<div class="container">
    <div class="container-fluid p-4" [ngClass]="{'fullscreen-modal': isMobileScreen}">
        <div class="row justify-content-center align-items-center">
            <div class="col-12">
                <h1 class="text-center" id="create-candidate">Add a new Candidate</h1>
            </div>
        </div>
        <form [formGroup]="newcandidateForm" (ngSubmit)="onSubmit(false)" id="newcandidateForm">
            <div class="row justify-content-center align-items-center">
                <div class="profile-photo">
                    <img id="imageUpload" [src]="employeeProfile.photo" alt="Profile Photo"
                        class="rounded-circle profile-img">
                </div>
                <div class="col-12 text-center roboto-font pb-3">
                    <h2 class="center-bold">Profile Picture</h2>
                    <p class="profile-text">PNG, JPG, SVG</p>
                    <p class="profile-text">10 MB Max limit size</p>
                    <button id="upload-button" mat-icon-button (click)="uploadFile.click()">
                        <span mat-icon-button matSuffix class="pe-3">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24">
                                <path
                                    d="M440-320v-326L336-542l-56-58 200-200 200 200-56 58-104-104v326h-80ZM240-160q-33 0-56.5-23.5T160-240v-120h80v120h480v-120h80v120q0 33-23.5 56.5T720-160H240Z" />
                            </svg>
                            Upload Picture Here
                        </span>
                        <input type="file" #uploadFile (change)="onFileChange($event)" hidden />
                    </button>
                    <p class="col-md-12 col-lg-7 info-text">*Required fields</p>
                </div>
                <div class="row flex-column justify-content-center align-items-center col-md-12">
                    <mat-form-field appearance="outline" class="col-md-12 col-lg-7">
                        <mat-label>First name</mat-label>
                        <input matInput type="text" formControlName="name" />
                        <mat-error *ngIf="newcandidateForm.controls['name'].hasError('required')">
                            First name is required
                        </mat-error>
                    </mat-form-field>
                    <mat-form-field appearance="outline" class="col-md-12 col-lg-7">
                        <mat-label>Last name</mat-label>
                        <input matInput type="text" formControlName="surname" />
                        <mat-error *ngIf="newcandidateForm.controls['surname'].hasError('required')">
                            Last name is required
                        </mat-error>
                    </mat-form-field>
                    <mat-form-field appearance="outline" class="col-md-12 col-lg-7">
                        <mat-label>Email</mat-label>
                        <input matInput type="text" formControlName="email" />
                        <mat-error *ngIf="newcandidateForm.controls['email'].hasError('required')">
                            valid Email is required
                        </mat-error>
                    </mat-form-field>
                </div>
                <!-- *ngIf="isValidEmail"  -->
                <div class="row col-md-12 flex-column justify-content-center align-items-center">
                    <mat-form-field appearance="outline" class="col-md-12 col-lg-7 my-1">
                        <mat-label>Contact number</mat-label>
                        <input matInput type="text" formControlName="contactNumber" />
                    </mat-form-field>

                    <mat-radio-group formControlName="role" class="col-md-12 col-lg-7 my-1 info-text">
                        <p class="col-md-12 col-lg-7 info-text">Role:</p>
                        <mat-radio-button value="UI/UX Designer">UI/UX Designer</mat-radio-button> <br />
                        <mat-radio-button value="Developer">Developer</mat-radio-button> <br />
                        <mat-radio-button value="Business Support">Business Support</mat-radio-button> <br />
                        <mat-radio-button value="Scrum Master">Scrum Master</mat-radio-button>
                    </mat-radio-group>

                    <mat-form-field appearance="outline" class="col-md-12 col-lg-7 my-1">
                        <mat-label>Select level</mat-label>
                        <mat-select formControlName="potentialLevel">
                            <mat-option *ngFor="let level of levels" [value]="level">{{ level }}</mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="col-md-12 col-lg-7 my-1">
                        <mat-label>e.g Johannesburg, Gauteng </mat-label>
                        <input matInput type="text" formControlName="location" />
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="col-md-12 col-lg-7 my-1">
                        <mat-label>Attach link</mat-label>
                        <input matInput type="text" formControlName="linkedInProfile" />
                        <mat-error *ngIf="newcandidateForm.controls['linkedInProfile'].hasError('required')">
                            Valid linkedIn Profile link is required
                        </mat-error>
                        <mat-icon matSuffix>link</mat-icon>
                    </mat-form-field>
                    <mat-form-field appearance="outline" class="col-md-12 col-lg-7 my-1">
                        <mat-label>CV</mat-label>
                        <input matInput type="text" [value]="cvFilename" />
                        <span mat-icon-button matSuffix class="pe-3">
                            <mat-icon *ngIf="isValidCVFile" (click)="uploadCVFile.click()"
                                id="file-upload-cursor">attach_file</mat-icon>
                            <mat-icon *ngIf="!isValidCVFile" (click)="clearCVFileUpload()"
                                class="change-close-color">close</mat-icon>
                        </span>
                        <input type="file" #uploadCVFile (change)="onCVFileChange($event)" hidden
                            accept=".pdf,.ppt,.pptx,.doc,.docx" />
                    </mat-form-field>

                    <div *ngIf="cvUrl !== ''">
                        <p>Selected CV: {{ cvFilename }}</p>
                    </div>


                    <p class="col-md-12 col-lg-7">PDF,PPT,PPTX,doc,Docx are supported</p>
                    <p class="col-md-12 col-lg-7">10 MB Max limit size</p>

                    <h4 class="col-md-12 col-lg-7 info-text">Portfolio</h4>
                    <mat-form-field appearance="outline" class="col-md-12 col-lg-7 my-1">
                        <mat-label>Attach website link</mat-label>
                        <input matInput type="text" formControlName="portfolioLink" />
                        <mat-icon matSuffix>link</mat-icon>
                        <mat-error *ngIf="newcandidateForm.controls['portfolioLink'].hasError('required')">
                            valid website link is required.
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="col-md-12 col-lg-7 my-1">
                        <mat-label>PDF</mat-label>
                        <input matInput type="text" [value]="portfolioFilename" />
                        <span mat-icon-button matSuffix class="pe-3">
                            <mat-icon *ngIf="isValidPortfolioFile" (click)="uploadPortfolioFile.click()"
                                id="file-upload-cursor">attach_file</mat-icon>
                            <mat-icon *ngIf="!isValidPortfolioFile" (click)="clearPortfolioFileUpload()"
                                class="change-close-color">close</mat-icon>
                        </span>
                        <input type="file" #uploadPortfolioFile (change)="onPortfolioFileChange($event)" hidden
                            accept=".pdf,.ppt,.pptx,.doc,.docx" />
                    </mat-form-field>
                    <div *ngIf="portfolioUrl!== ''">
                        <p>Selected CV: {{ portfolioFilename }}</p>
                    </div>
                    <p class="col-md-12 col-lg-7">PDF,PPT,PPTX,doc,Docx are supported</p>
                    <p class="col-md-12 col-lg-7">10 MB Max limit size</p>

                    <mat-slide-toggle class="col-md-12 col-lg-7 mb-3" color="primary" id="additionalFieldsToggle"
                        (click)="toggleAdditionalFields()">
                        Additional fields
                    </mat-slide-toggle>
                    <div *ngIf="additionalFieldsVisible"
                        class="row col-md-12 flex-column justify-content-center align-items-center">
                        <mat-radio-group formControlName="role" class="col-md-12 col-lg-7 my-1 info-text">
                            <p class="col-md-12 col-lg-7 info-text">Gender:</p>
                            <mat-radio-button value="Unclassified">Unclassified</mat-radio-button> <br />
                            <mat-radio-button value="Male">Male</mat-radio-button> <br />
                            <mat-radio-button value="Female">Female</mat-radio-button> <br />
                        </mat-radio-group>
                        <mat-form-field appearance="outline" class="col-lg-7 col-md-12">
                            <mat-label>Race</mat-label>
                            <mat-select formControlName="race">
                                <mat-option *ngFor="let race of races; index as i" [value]="i">{{ race }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <mat-form-field appearance="outline" class="col-md-12 col-lg-7 my-1">
                            <mat-label>ID Number/ Passport</mat-label>
                            <input matInput type="text" formControlName="idNumber" />
                        </mat-form-field>
                        <mat-form-field appearance="outline" class="col-lg-7 col-md-12">
                            <mat-label>Referral</mat-label>
                            <input matInput placeholder="Referral" [formControl]="searchControl"
                                [matAutocomplete]="auto">
                            <mat-autocomplete #auto="matAutocomplete">
                                <mat-option *ngFor="let employee of filteredEmployees | async" [value]="employee.id">
                                    {{ employee.name }}
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field>
                        <h4 class="col-md-12 col-lg-7 mb-2 info-text">Qualifications</h4>
                        <mat-form-field appearance="outline" class="col-md-12 col-lg-7 my-1">
                            <mat-icon matPrefix>search</mat-icon>
                            <mat-label>Highest Qualification</mat-label>
                            <mat-select formControlName="highestQualification">
                                <mat-option *ngFor="let qualification of qualifications; index as i" [value]="i">{{
                                    qualification }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <mat-form-field appearance="outline" class="col-md-12 col-lg-7 my-1">
                            <mat-icon matPrefix>search</mat-icon>
                            <mat-label>School</mat-label>
                            <mat-select *ngIf="!optionIsOther" formControlName="school"
                                (selectionChange)="toggleOtherSchoolField($event)">
                                <mat-option *ngFor="let school of schools; index as i" [value]="i">{{ school
                                    }}</mat-option>

                            </mat-select>
                            <input *ngIf="optionIsOther" matInput type="text" formControlName="school"
                                placeholder="Enter other school">
                        </mat-form-field>
                        <mat-form-field appearance="outline" class="col-md-12 col-lg-7 my-1">
                            <mat-label>Date Obtained</mat-label>
                            <mat-select formControlName="startDate" placeholder="Select start year">
                                <mat-option *ngFor="let year of years" [value]="year">{{ year }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                </div>
                <div id="footer" class="col-md-12">
                    <button id="cancel-button" [ngClass]="screenWidth < 768 ? 'button-mobile' : ''"
                        (click)="goToPreviousPage()">Cancel</button>
                    <button *ngIf="!isValidEmail" id="next-button"
                        [ngClass]="screenWidth < 768 ? 'button-mobile button-top' : ''"
                        (click)="checkEmailValidity()">Next</button>
                    <button *ngIf="isValidEmail" id="save-add-button"
                        [ngClass]="screenWidth < 768 ? 'button-mobile' : ''">Save and add another</button>
                    <button *ngIf="isValidEmail" id="save-button"
                        [ngClass]="screenWidth < 768 ? 'button-mobile  button-top' : ''">Save</button>
                </div>
            </div>
        </form>
    </div>
</div>