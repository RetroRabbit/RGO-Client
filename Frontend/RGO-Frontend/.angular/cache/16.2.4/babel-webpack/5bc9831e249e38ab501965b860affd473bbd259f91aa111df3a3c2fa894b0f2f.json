{"ast":null,"code":"import { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { catchError, map, of } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/employee.service\";\nimport * as i2 from \"src/app/services/evaluation.service\";\nimport * as i3 from \"src/app/services/employee-evaluations-rating.service\";\nimport * as i4 from \"src/app/services/evaluation-template.service\";\nimport * as i5 from \"src/app/services/evaluation-template-item.service\";\nimport * as i6 from \"src/app/services/evaluation-audience.service\";\nimport * as i7 from \"ngx-cookie-service\";\nfunction EvaluationsComponent_option_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const employee_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", employee_r4[\"email\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", employee_r4[\"name\"] + \" \" + employee_r4[\"surname\"], \" \");\n  }\n}\nfunction EvaluationsComponent_section_12_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function EvaluationsComponent_section_12_button_4_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r10.saveEvaluation());\n    });\n    i0.ɵɵtext(1, \" Save \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EvaluationsComponent_section_12_button_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function EvaluationsComponent_section_12_button_5_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.updateEvaluation());\n    });\n    i0.ɵɵtext(1, \" Update \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EvaluationsComponent_section_12_button_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 31);\n    i0.ɵɵlistener(\"click\", function EvaluationsComponent_section_12_button_6_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r14.removeEvaluation());\n    });\n    i0.ɵɵtext(1, \" Delete \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction EvaluationsComponent_section_12_option_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const template_r16 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", template_r16.description);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", template_r16[\"description\"], \" \");\n  }\n}\nfunction EvaluationsComponent_section_12_div_28_section_1_div_7_span_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 40);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r22 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", item_r22, \" \");\n  }\n}\nfunction EvaluationsComponent_section_12_div_28_section_1_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 37)(1, \"h5\", 38)(2, \"b\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(4, EvaluationsComponent_section_12_div_28_section_1_div_7_span_4_Template, 2, 1, \"span\", 39);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const section_r20 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(section_r20.key);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", section_r20.value);\n  }\n}\nfunction EvaluationsComponent_section_12_div_28_section_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"section\", 33)(1, \"div\", 34)(2, \"h4\");\n    i0.ɵɵtext(3, \" Template: \");\n    i0.ɵɵelementStart(4, \"b\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(6, \"div\", 35);\n    i0.ɵɵtemplate(7, EvaluationsComponent_section_12_div_28_section_1_div_7_Template, 5, 2, \"div\", 36);\n    i0.ɵɵpipe(8, \"keyvalue\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const templateDesc_r18 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(templateDesc_r18.key);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(8, 2, templateDesc_r18.value));\n  }\n}\nfunction EvaluationsComponent_section_12_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, EvaluationsComponent_section_12_div_28_section_1_Template, 9, 4, \"section\", 32);\n    i0.ɵɵpipe(2, \"keyvalue\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(2, 1, ctx_r9.templateItems));\n  }\n}\nfunction EvaluationsComponent_section_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"section\", 10)(1, \"form\", 11)(2, \"header\", 12)(3, \"div\", 13);\n    i0.ɵɵtemplate(4, EvaluationsComponent_section_12_button_4_Template, 2, 0, \"button\", 14);\n    i0.ɵɵtemplate(5, EvaluationsComponent_section_12_button_5_Template, 2, 0, \"button\", 15);\n    i0.ɵɵtemplate(6, EvaluationsComponent_section_12_button_6_Template, 2, 0, \"button\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"hr\");\n    i0.ɵɵelementStart(8, \"div\", 17)(9, \"div\", 18);\n    i0.ɵɵelement(10, \"input\", 19);\n    i0.ɵɵelementStart(11, \"label\", 20);\n    i0.ɵɵtext(12, \"Email Address(Owner)\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"div\", 18);\n    i0.ɵɵelement(14, \"input\", 21);\n    i0.ɵɵelementStart(15, \"label\", 22);\n    i0.ɵɵtext(16, \"Email Address(Employee)\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"div\", 18);\n    i0.ɵɵelement(18, \"input\", 23);\n    i0.ɵɵelementStart(19, \"label\", 24);\n    i0.ɵɵtext(20, \"Subject\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(21, \"div\", 18)(22, \"datalist\", 25);\n    i0.ɵɵlistener(\"change\", function EvaluationsComponent_section_12_Template_datalist_change_22_listener($event) {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.tempChange($event));\n    });\n    i0.ɵɵtemplate(23, EvaluationsComponent_section_12_option_23_Template, 2, 2, \"option\", 7);\n    i0.ɵɵpipe(24, \"async\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"input\", 26);\n    i0.ɵɵlistener(\"input\", function EvaluationsComponent_section_12_Template_input_input_25_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r25 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r25.templateChange());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"label\", 27);\n    i0.ɵɵtext(27, \"Template\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵtemplate(28, EvaluationsComponent_section_12_div_28_Template, 3, 3, \"div\", 28);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.EvaluationForm);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.selectedEvaluation === null);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.selectedEvaluation !== null);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.selectedEvaluation !== null);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"value\", ctx_r1.selectedEvaluation == null ? null : ctx_r1.selectedEvaluation.owner == null ? null : ctx_r1.selectedEvaluation.owner.email);\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(24, 7, ctx_r1.templates$));\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.EvaluationForm.controls[\"template\"].valid);\n  }\n}\nfunction EvaluationsComponent_section_13_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r29 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 48)(1, \"button\", 49);\n    i0.ɵɵlistener(\"click\", function EvaluationsComponent_section_13_div_14_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r29);\n      const member_r27 = restoredCtx.$implicit;\n      const ctx_r28 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r28.deleteEvaluationAudience(member_r27.email));\n    });\n    i0.ɵɵelementStart(2, \"i\", 43);\n    i0.ɵɵtext(3, \"remove_circle\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"span\")(5, \"b\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"br\");\n    i0.ɵɵelementStart(8, \"i\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const member_r27 = ctx.$implicit;\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(member_r27.name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(member_r27.email);\n  }\n}\nfunction EvaluationsComponent_section_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r31 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"section\", 10)(1, \"div\", 17)(2, \"h5\")(3, \"i\");\n    i0.ɵɵtext(4, \"Audience Members:\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"form\", 41)(6, \"button\", 42);\n    i0.ɵɵlistener(\"click\", function EvaluationsComponent_section_13_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r31);\n      const ctx_r30 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r30.saveEvaluationAudience());\n    });\n    i0.ɵɵelementStart(7, \"i\", 43);\n    i0.ɵɵtext(8, \"add_circle\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 44);\n    i0.ɵɵelement(10, \"input\", 45);\n    i0.ɵɵelementStart(11, \"label\", 46);\n    i0.ɵɵtext(12, \"Audience\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelement(13, \"hr\");\n    i0.ɵɵtemplate(14, EvaluationsComponent_section_13_div_14_Template, 10, 2, \"div\", 47);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"formGroup\", ctx_r2.AudienceForm);\n    i0.ɵɵadvance(9);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.audience);\n  }\n}\nconst _c0 = function (a0, a1) {\n  return {\n    \"star-filled\": a0,\n    star: a1\n  };\n};\nfunction EvaluationsComponent_section_14_span_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 67);\n    i0.ɵɵtext(1, \"\\u2605\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r35 = ctx.index;\n    const ctx_r32 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(1, _c0, i_r35 < ctx_r32.RatingForm.value.score, i_r35 >= ctx_r32.RatingForm.value.score));\n  }\n}\nfunction EvaluationsComponent_section_14_div_28_span_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 67);\n    i0.ɵɵtext(1, \"\\u2605\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r39 = ctx.index;\n    const rating_r36 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(1, _c0, i_r39 < rating_r36[\"score\"], i_r39 >= rating_r36[\"score\"]));\n  }\n}\nfunction EvaluationsComponent_section_14_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r42 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 68)(2, \"button\", 49);\n    i0.ɵɵlistener(\"click\", function EvaluationsComponent_section_14_div_28_Template_button_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r42);\n      const rating_r36 = restoredCtx.$implicit;\n      const ctx_r41 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r41.deleteEvaluationRating(rating_r36));\n    });\n    i0.ɵɵelementStart(3, \"i\", 43);\n    i0.ɵɵtext(4, \"remove_circle\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"span\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, EvaluationsComponent_section_14_div_28_span_7_Template, 2, 4, \"span\", 55);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 69)(9, \"label\", 70);\n    i0.ɵɵtext(10, \"Comments:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"textarea\", 71);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const rating_r36 = ctx.$implicit;\n    const ctx_r33 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(rating_r36[\"description\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r33.stars);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"            \", rating_r36[\"comment\"], \"\\n        \");\n  }\n}\nfunction EvaluationsComponent_section_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r44 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"section\", 10)(1, \"form\", 11)(2, \"div\", 13)(3, \"input\", 50);\n    i0.ɵɵlistener(\"click\", function EvaluationsComponent_section_14_Template_input_click_3_listener() {\n      i0.ɵɵrestoreView(_r44);\n      const ctx_r43 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r43.saveEvaluationRating());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"input\", 51);\n    i0.ɵɵlistener(\"click\", function EvaluationsComponent_section_14_Template_input_click_4_listener() {\n      i0.ɵɵrestoreView(_r44);\n      const ctx_r45 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r45.clearRatingForm());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 18);\n    i0.ɵɵelement(6, \"input\", 52);\n    i0.ɵɵelementStart(7, \"label\", 53);\n    i0.ɵɵtext(8, \"Description\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(9, \"hr\");\n    i0.ɵɵelementStart(10, \"div\", 54)(11, \"label\");\n    i0.ɵɵtext(12, \" Score \");\n    i0.ɵɵtemplate(13, EvaluationsComponent_section_14_span_13_Template, 2, 4, \"span\", 55);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(14, \"br\")(15, \"input\", 56);\n    i0.ɵɵelementStart(16, \"datalist\", 57);\n    i0.ɵɵelement(17, \"option\", 58)(18, \"option\", 59)(19, \"option\", 60)(20, \"option\", 61)(21, \"option\", 62)(22, \"option\", 63);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(23, \"hr\");\n    i0.ɵɵelementStart(24, \"div\", 18);\n    i0.ɵɵelement(25, \"textarea\", 64);\n    i0.ɵɵelementStart(26, \"label\", 65);\n    i0.ɵɵtext(27, \"Comment\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(28, EvaluationsComponent_section_14_div_28_Template, 13, 3, \"div\", 66);\n    i0.ɵɵpipe(29, \"async\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r3.RatingForm);\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.stars);\n    i0.ɵɵadvance(15);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(29, 3, ctx_r3.rating$));\n  }\n}\nconst _c1 = function (a0, a1) {\n  return {\n    \"nav-link btn btn-primary active\": a0,\n    \"nav-link btn btn-info\": a1\n  };\n};\nexport let EvaluationsComponent = /*#__PURE__*/(() => {\n  class EvaluationsComponent {\n    constructor(empoloyeeService, evaluationService, evaluationRatingService, evaluationtemplate, evaluationTemplateItemService, evaluationAudienceService, cookieService) {\n      this.empoloyeeService = empoloyeeService;\n      this.evaluationService = evaluationService;\n      this.evaluationRatingService = evaluationRatingService;\n      this.evaluationtemplate = evaluationtemplate;\n      this.evaluationTemplateItemService = evaluationTemplateItemService;\n      this.evaluationAudienceService = evaluationAudienceService;\n      this.cookieService = cookieService;\n      this.currentTab = 'Template';\n      this.EvaluationForm = new FormGroup({\n        ownerEmail: new FormControl('', Validators.required),\n        employeeEmail: new FormControl('', Validators.required),\n        template: new FormControl('', Validators.required),\n        subject: new FormControl('', Validators.required),\n        startDate: new FormControl('', Validators.required)\n      });\n      this.AudienceForm = new FormGroup({\n        email: new FormControl('', Validators.required)\n      });\n      this.RatingForm = new FormGroup({\n        description: new FormControl('', Validators.required),\n        score: new FormControl(0, Validators.required),\n        comment: new FormControl('', Validators.required)\n      });\n      this.audience = [];\n      this.stars = ['star', 'star', 'star', 'star', 'star'];\n      this.templateItems = {};\n    }\n    fetchAudience() {\n      const evaluationInput = {\n        id: 0,\n        ownerEmail: this.selectedEvaluation?.owner.email,\n        employeeEmail: this.selectedEvaluation?.employee.email,\n        template: this.selectedEvaluation?.template.description,\n        subject: this.selectedEvaluation?.subject\n      };\n      this.evaluationAudienceService.getAll(evaluationInput).pipe(map(data => data.map(member => ({\n        email: member?.employee?.email,\n        name: `${member?.employee?.name} ${member?.employee?.surname}`\n      }))), catchError(() => {\n        return of([]);\n      })).subscribe(audience => this.audience = audience);\n    }\n    updateRatings() {\n      const evaluationInput = {\n        id: 0,\n        ownerEmail: this.selectedEvaluation?.owner.email,\n        employeeEmail: this.selectedEvaluation?.employee.email,\n        template: this.selectedEvaluation?.template.description,\n        subject: this.selectedEvaluation?.subject\n      };\n      this.rating$ = this.evaluationRatingService.getall(evaluationInput);\n    }\n    setFormValues() {\n      this.EvaluationForm.setValue({\n        ownerEmail: this.selectedEvaluation ? this.selectedEvaluation?.owner.email : '',\n        employeeEmail: this.selectedEvaluation ? this.selectedEvaluation?.employee.email : '',\n        template: this.selectedEvaluation ? this.selectedEvaluation?.template.description : '',\n        subject: this.selectedEvaluation ? this.selectedEvaluation?.subject : '',\n        startDate: new Date(Date.now())\n      });\n      this.templateChange();\n    }\n    ngOnInit() {\n      this.employees$ = this.empoloyeeService.getAll();\n      this.templates$ = this.evaluationtemplate.getAll();\n      if (this.selectedEvaluation) {\n        this.fetchAudience();\n        this.updateRatings();\n        this.setFormValues();\n      } else {\n        this.templateChange();\n      }\n    }\n    templateChange() {\n      let templateItemSub;\n      if (this.EvaluationForm.value.template !== null && this.EvaluationForm.value.template !== '') templateItemSub = this.evaluationTemplateItemService.getAll(this.EvaluationForm.value.template);else return;\n      templateItemSub?.pipe(map(items => {\n        const grouped = {};\n        items.forEach(item => {\n          const templateDesc = item?.template?.description;\n          const section = item?.section;\n          if (!grouped[templateDesc]) grouped[templateDesc] = {};\n          if (!grouped[templateDesc][section]) grouped[templateDesc][section] = [];\n          grouped[templateDesc][section].push(item?.question);\n        });\n        return grouped;\n      }), catchError(error => {\n        console.error(`Error: ${error}`);\n        return of({});\n      })).subscribe(grouped => {\n        this.templateItems = grouped;\n      });\n    }\n    tempChange(htmlValue) {\n      this.EvaluationForm.patchValue({\n        template: htmlValue.target.value\n      });\n    }\n    saveEvaluation() {\n      console.table(this.EvaluationForm.value);\n      const evaluation = this.evaluationInput;\n      this.evaluationService.save(evaluation).subscribe(() => {\n        this.EvaluationForm.reset();\n        this.backToEvaluations();\n      }, () => {});\n    }\n    saveEvaluationAudience() {\n      const evaluation = this.evaluationInput;\n      this.evaluationAudienceService.save(this.AudienceForm.value.email, evaluation).subscribe(() => {\n        this.fetchAudience();\n        this.updateRatings();\n      }, () => {});\n    }\n    deleteEvaluationAudience(email) {\n      const evaluation = this.evaluationInput;\n      this.evaluationAudienceService.delete(email, evaluation).subscribe(() => {\n        console.info('Evaluation audience deleted');\n        this.evaluationAudienceService.getAll({\n          id: 0,\n          ownerEmail: this.selectedEvaluation?.owner.email,\n          employeeEmail: this.selectedEvaluation?.employee.email,\n          template: this.selectedEvaluation?.template.description,\n          subject: this.selectedEvaluation?.subject\n        }).pipe(map(data => {\n          const audience = [];\n          data.forEach(member => {\n            const employee = member?.employee;\n            audience.push({\n              email: employee.email,\n              name: employee.name + ' ' + employee.surname\n            });\n          });\n          return audience;\n        }), catchError(error => {\n          console.error(`Error: ${error}`);\n          return of([]);\n        })).subscribe(x => this.audience = x);\n        this.rating$ = this.evaluationRatingService.getall({\n          id: 0,\n          ownerEmail: this.selectedEvaluation?.owner.email,\n          employeeEmail: this.selectedEvaluation?.employee.email,\n          template: this.selectedEvaluation?.template.description,\n          subject: this.selectedEvaluation?.subject\n        });\n      }, () => {\n        console.error('Error deleting evaluation audience');\n      });\n    }\n    get evaluationRating() {\n      return {\n        id: 0,\n        employeeEmail: this.cookieService.get('userEmail'),\n        evaluation: this.evaluationInput,\n        description: this.RatingForm.value.description,\n        score: this.RatingForm.value.score,\n        comment: this.RatingForm.value.comment\n      };\n    }\n    saveEvaluationRating() {\n      this.evaluationRatingService.save(this.evaluationRating).subscribe(() => {\n        console.info('Evaluation rating saved');\n        this.rating$ = this.evaluationRatingService.getall({\n          id: 0,\n          ownerEmail: this.selectedEvaluation?.owner.email,\n          employeeEmail: this.selectedEvaluation?.employee.email,\n          template: this.selectedEvaluation?.template.description,\n          subject: this.selectedEvaluation?.subject\n        });\n      }, () => {\n        console.error('Error saving evaluation rating');\n      });\n    }\n    deleteEvaluationRating(rating) {\n      const evaluationRating = {\n        id: rating.id,\n        employeeEmail: rating.employee.email,\n        evaluation: this.evaluationInput,\n        description: rating.description,\n        score: rating.score,\n        comment: rating.comment\n      };\n      this.evaluationRatingService.delete(evaluationRating).subscribe(() => {\n        console.info('Evaluation rating deleted');\n        this.rating$ = this.evaluationRatingService.getall({\n          id: 0,\n          ownerEmail: this.selectedEvaluation?.owner.email,\n          employeeEmail: this.selectedEvaluation?.employee.email,\n          template: this.selectedEvaluation?.template.description,\n          subject: this.selectedEvaluation?.subject\n        });\n      }, () => {\n        console.error('Error deleting evaluation rating');\n      });\n    }\n    clearRatingForm() {\n      this.RatingForm.reset();\n      this.stars = ['star', 'star', 'star', 'star', 'star'];\n    }\n    updateEvaluation() {\n      const evaluationInputs = [this.evaluationInput, {\n        id: null,\n        ownerEmail: this.EvaluationForm.value.ownerEmail,\n        employeeEmail: this.EvaluationForm.value.employeeEmail,\n        template: this.EvaluationForm.value.template,\n        subject: this.EvaluationForm.value.subject\n      }];\n      this.evaluationService.update(evaluationInputs).subscribe(() => {\n        this.EvaluationForm.reset();\n        this.backToEvaluations();\n      }, () => {});\n    }\n    get evaluationInput() {\n      return {\n        id: 0,\n        ownerEmail: this.EvaluationForm.value.ownerEmail,\n        employeeEmail: this.EvaluationForm.value.employeeEmail,\n        template: this.EvaluationForm.value.template,\n        subject: this.EvaluationForm.value.subject\n      };\n    }\n    removeEvaluation() {\n      const evaluationInput = this.evaluationInput;\n      this.evaluationService.delete(evaluationInput).subscribe(() => {\n        this.EvaluationForm.reset();\n        this.backToEvaluations();\n      }, () => {\n        this.EvaluationForm.reset();\n      });\n    }\n    backToEvaluations() {\n      this.cookieService.set('currentPage', 'Evaluations');\n      this.selectedEvaluation = null;\n    }\n    rate(selectedStar, index) {\n      ++index;\n      for (let i = 0; i < this.stars.length; i++) {\n        this.stars[i] = i < index ? this.stars[i] = 'star-filled' : 'star';\n      }\n    }\n    static #_ = this.ɵfac = function EvaluationsComponent_Factory(t) {\n      return new (t || EvaluationsComponent)(i0.ɵɵdirectiveInject(i1.EmployeeService), i0.ɵɵdirectiveInject(i2.EvaluationService), i0.ɵɵdirectiveInject(i3.EmployeeEvaluationsRatingService), i0.ɵɵdirectiveInject(i4.EvaluationTemplateService), i0.ɵɵdirectiveInject(i5.EvaluationTemplateItemService), i0.ɵɵdirectiveInject(i6.EvaluationAudienceService), i0.ɵɵdirectiveInject(i7.CookieService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: EvaluationsComponent,\n      selectors: [[\"app-evaluations\"]],\n      inputs: {\n        selectedEvaluation: \"selectedEvaluation\"\n      },\n      decls: 15,\n      vars: 18,\n      consts: [[1, \"nav\"], [1, \"nav-item\"], [\"type\", \"button\", \"value\", \"Back\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [\"type\", \"button\", \"value\", \"Template\", 3, \"ngClass\", \"click\"], [\"type\", \"button\", \"value\", \"Audience\", 3, \"ngClass\", \"click\"], [\"type\", \"button\", \"value\", \"Rating\", 3, \"ngClass\", \"click\"], [\"id\", \"email-list\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"fluid-contaier\", 4, \"ngIf\"], [3, \"value\"], [1, \"fluid-contaier\"], [3, \"formGroup\"], [1, \"fluid-container\", \"p-3\", \"bg-info\", \"bg-opacity-10\", \"border\", \"border-info\", \"border-start-0\", \"rounded-end\"], [\"role\", \"group\", 1, \"btn-group\"], [\"type\", \"submit\", \"class\", \"btn btn-primary\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"submit\", \"class\", \"btn btn-warning\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"button\", \"class\", \"btn btn-danger\", 3, \"click\", 4, \"ngIf\"], [1, \"row\", \"g2\"], [1, \"form-floating\", \"mb-3\", \"col-md\"], [\"list\", \"email-list\", \"id\", \"owner\", \"aria-describedby\", \"owner-email\", \"formControlName\", \"ownerEmail\", 1, \"form-control\", \"form-control-sm\", \"col-auto\", \"border-bottom\", \"border-success\", 3, \"value\"], [\"for\", \"owner\", 1, \"p-3\"], [\"list\", \"email-list\", \"id\", \"employee\", \"aria-describedby\", \"employee-email\", \"formControlName\", \"employeeEmail\", 1, \"form-control\", \"form-control-sm\", \"col-auto\", \"border-bottom\", \"border-success\"], [\"for\", \"employee\", 1, \"p-3\"], [\"id\", \"subject\", \"aria-describedby\", \"subject\", \"formControlName\", \"subject\", 1, \"form-control\", \"form-control-sm\", \"col-auto\", \"border-bottom\", \"border-success\"], [\"for\", \"subject\", 1, \"p-3\"], [\"id\", \"template-list\", 3, \"change\"], [\"list\", \"template-list\", \"id\", \"description\", \"aria-describedby\", \"template\", \"formControlName\", \"template\", 1, \"form-control\", \"form-control-sm\", \"col-auto\", \"border-bottom\", \"border-success\", 3, \"input\"], [\"for\", \"description\", 1, \"p-3\"], [4, \"ngIf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-warning\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"], [\"class\", \"card\", 4, \"ngFor\", \"ngForOf\"], [1, \"card\"], [1, \"card-header\"], [1, \"card-body\"], [\"class\", \"border-bottom border-secondary\", 4, \"ngFor\", \"ngForOf\"], [1, \"border-bottom\", \"border-secondary\"], [1, \"card-title\"], [\"class\", \"card-text\", 4, \"ngFor\", \"ngForOf\"], [1, \"card-text\"], [1, \"d-flex\", 3, \"formGroup\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"btn-sm\", 3, \"click\"], [1, \"material-icons\"], [1, \"form-floating\", \"col-md\"], [\"type\", \"email\", \"list\", \"email-list\", \"id\", \"newAudience\", \"formControlName\", \"email\", 1, \"form-control\", \"form-control-sm\", \"col-sm\", \"border-bottom\", \"border-success\"], [\"for\", \"newAudience\", 1, \"p-3\"], [\"class\", \"mb-3 col-md d-flex\", 4, \"ngFor\", \"ngForOf\"], [1, \"mb-3\", \"col-md\", \"d-flex\"], [\"type\", \"submit\", 1, \"btn\", \"btn-danger\", \"btn-sm\", 3, \"click\"], [\"type\", \"submit\", \"value\", \"Save\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"type\", \"submit\", \"value\", \"Clear\", 1, \"btn\", \"btn-warning\", 3, \"click\"], [\"type\", \"text\", \"id\", \"description\", \"formControlName\", \"description\", 1, \"form-control\", \"form-control-md\", \"col-auto\", \"border-bottom\", \"border-success\"], [\"for\", \"description\"], [1, \"mb-3\", \"col-md\"], [3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"range\", \"list\", \"markers\", \"min\", \"0\", \"max\", \"5\", \"step\", \"1\", \"id\", \"score\", \"formControlName\", \"score\"], [\"id\", \"markers\"], [\"value\", \"0\", \"label\", \"0\"], [\"value\", \"1\", \"label\", \"1\"], [\"value\", \"2\", \"label\", \"2\"], [\"value\", \"3\", \"label\", \"3\"], [\"value\", \"4\", \"label\", \"4\"], [\"value\", \"5\", \"label\", \"5\"], [\"type\", \"text\", \"id\", \"comment\", \"formControlName\", \"comment\", 1, \"form-control\", \"form-control-md\", \"col-auto\", \"border-bottom\", \"border-success\"], [\"for\", \"comment\"], [4, \"ngFor\", \"ngForOf\"], [3, \"ngClass\"], [1, \"star-rating\"], [1, \"comments-section\"], [\"for\", \"comments\"], [\"id\", \"comments\", \"rows\", \"4\", \"disabled\", \"\", 1, \"form-control\"]],\n      template: function EvaluationsComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"ul\", 0)(1, \"li\", 1)(2, \"input\", 2);\n          i0.ɵɵlistener(\"click\", function EvaluationsComponent_Template_input_click_2_listener() {\n            return ctx.backToEvaluations();\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(3, \"li\", 1)(4, \"input\", 3);\n          i0.ɵɵlistener(\"click\", function EvaluationsComponent_Template_input_click_4_listener() {\n            return ctx.currentTab = \"Template\";\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(5, \"li\", 1)(6, \"input\", 4);\n          i0.ɵɵlistener(\"click\", function EvaluationsComponent_Template_input_click_6_listener() {\n            return ctx.currentTab = \"Audience\";\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(7, \"li\", 1)(8, \"input\", 5);\n          i0.ɵɵlistener(\"click\", function EvaluationsComponent_Template_input_click_8_listener() {\n            return ctx.currentTab = \"Rating\";\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(9, \"datalist\", 6);\n          i0.ɵɵtemplate(10, EvaluationsComponent_option_10_Template, 2, 2, \"option\", 7);\n          i0.ɵɵpipe(11, \"async\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(12, EvaluationsComponent_section_12_Template, 29, 9, \"section\", 8);\n          i0.ɵɵtemplate(13, EvaluationsComponent_section_13_Template, 15, 2, \"section\", 8);\n          i0.ɵɵtemplate(14, EvaluationsComponent_section_14_Template, 30, 5, \"section\", 8);\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(9, _c1, ctx.currentTab === \"Template\", ctx.currentTab !== \"Template\"));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(12, _c1, ctx.currentTab === \"Audience\", ctx.currentTab !== \"Audience\"));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(15, _c1, ctx.currentTab === \"Rating\", ctx.currentTab !== \"Rating\"));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(11, 7, ctx.employees$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.currentTab === \"Template\");\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.currentTab === \"Audience\");\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.currentTab === \"Rating\");\n        }\n      },\n      styles: [\".star-rating[_ngcontent-%COMP%]{font-size:24px;display:flex;justify-content:center;margin-bottom:10px}.star[_ngcontent-%COMP%]{color:gray;cursor:pointer;margin:0 5px;transition:color .2s}.star-filled[_ngcontent-%COMP%]{color:gold}.comments-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-width:400px;margin:0 auto}.comments-section[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;border-radius:5px;padding:10px;border:1px solid #ccc;resize:vertical}\"]\n    });\n  }\n  return EvaluationsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}