{"ast":null,"code":"import { GetLogin } from '../../store/actions/login-in.actions';\nimport { map, switchMap, take, tap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/store\";\nimport * as i2 from \"@auth0/auth0-angular\";\nimport * as i3 from \"../../services/auth.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"ngx-cookie-service\";\nexport class SignInComponent {\n  constructor(store, auth, authService, router, cookieService) {\n    this.store = store;\n    this.auth = auth;\n    this.authService = authService;\n    this.router = router;\n    this.cookieService = cookieService;\n    this.token = null;\n    this.userEmail = null;\n  }\n  ngOnInit() {\n    this.token = this.cookieService.get('userToken');\n    this.userEmail = this.cookieService.get('userEmail');\n  }\n  Login() {\n    this.cookieService.deleteAll();\n    this.auth.loginWithPopup().pipe(take(1), switchMap(() => this.auth.user$.pipe(take(1))), switchMap(user => {\n      this.cookieService.set('userEmail', user?.email || '');\n      return this.authService.login(user?.email).pipe(tap(token => this.cookieService.set('userToken', token)), map(token => ({\n        user,\n        token\n      })));\n    }), switchMap(({\n      user,\n      token\n    }) => this.authService.FetchRoles(user?.email).pipe(tap(roles => this.cookieService.set('userType', roles)), map(roles => ({\n      user,\n      token,\n      roles\n    }))))).subscribe({\n      next: ({\n        user,\n        token,\n        roles\n      }) => {\n        const googleID = {\n          email: user?.email,\n          token: token,\n          roles: roles\n        };\n        this.store.dispatch(GetLogin({\n          payload: googleID\n        }));\n        this.router.navigateByUrl('/home');\n      },\n      error: error => {}\n    });\n  }\n  static #_ = this.ɵfac = function SignInComponent_Factory(t) {\n    return new (t || SignInComponent)(i0.ɵɵdirectiveInject(i1.Store), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.AuthService), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i5.CookieService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SignInComponent,\n    selectors: [[\"app-sign-in\"]],\n    decls: 17,\n    vars: 0,\n    consts: [[1, \"vh-100\", \"gradient-custom\"], [1, \"container\", \"py-5\", \"h-100\"], [1, \"row\", \"d-flex\", \"justify-content-center\", \"align-items-center\", \"h-100\"], [1, \"col-md-6\"], [1, \"card\"], [3, \"ngSubmit\"], [1, \"card-header\", \"card-header-primary\"], [1, \"card-title\"], [1, \"card-category\"], [1, \"card-body\", \"d-flex\", \"justify-content-center\", \"text-center\"], [1, \"login-p\"], [\"type\", \"submit\", \"mat-raised-button\", \"\", 1, \"btn\", \"btn-primary\"]],\n    template: function SignInComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"form\", 5);\n        i0.ɵɵlistener(\"ngSubmit\", function SignInComponent_Template_form_ngSubmit_5_listener() {\n          return ctx.Login();\n        });\n        i0.ɵɵelementStart(6, \"div\", 6)(7, \"h4\", 7);\n        i0.ɵɵtext(8, \"Grad Onboarding Platform\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"p\", 8);\n        i0.ɵɵtext(10, \"Welcome to the grad program\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(11, \"div\", 9)(12, \"p\", 10);\n        i0.ɵɵtext(13, \" Maybe add some text here. I don't know, I'm not a designer. \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"div\", 9)(15, \"button\", 11);\n        i0.ɵɵtext(16, \" Login \");\n        i0.ɵɵelementEnd()()()()()()()();\n      }\n    },\n    styles: [\".card[_ngcontent-%COMP%]{\\n  background-color: #424242;\\n  height: 18rem;\\n\\n}\\n\\n.login-p[_ngcontent-%COMP%]{\\n  color: white;\\n}\\n\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9zaWduLWluL3NpZ24taW4uY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLHlCQUF5QjtFQUN6QixhQUFhOztBQUVmOztBQUVBO0VBQ0UsWUFBWTtBQUNkIiwic291cmNlc0NvbnRlbnQiOlsiLmNhcmR7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzQyNDI0MjtcclxuICBoZWlnaHQ6IDE4cmVtO1xyXG5cclxufVxyXG5cclxuLmxvZ2luLXB7XHJcbiAgY29sb3I6IHdoaXRlO1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n  });\n}","map":{"version":3,"names":["GetLogin","map","switchMap","take","tap","SignInComponent","constructor","store","auth","authService","router","cookieService","token","userEmail","ngOnInit","get","Login","deleteAll","loginWithPopup","pipe","user$","user","set","email","login","FetchRoles","roles","subscribe","next","googleID","dispatch","payload","navigateByUrl","error","_","i0","ɵɵdirectiveInject","i1","Store","i2","AuthService","i3","i4","Router","i5","CookieService","_2","selectors","decls","vars","consts","template","SignInComponent_Template","rf","ctx","ɵɵelementStart","ɵɵlistener","SignInComponent_Template_form_ngSubmit_5_listener","ɵɵtext","ɵɵelementEnd"],"sources":["C:\\Users\\HP\\Desktop\\GOP\\RGO-Client\\Frontend\\RGO-Frontend\\src\\app\\components\\sign-in\\sign-in.component.ts","C:\\Users\\HP\\Desktop\\GOP\\RGO-Client\\Frontend\\RGO-Frontend\\src\\app\\components\\sign-in\\sign-in.component.html"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { Store } from '@ngrx/store';\r\nimport { GetLogin } from '../../store/actions/login-in.actions';\r\nimport * as Auth0 from '@auth0/auth0-angular';\r\nimport { Token } from '../../models/token.interface';\r\nimport { map, switchMap, take, tap } from 'rxjs';\r\nimport { AuthService } from '../../services/auth.service';\r\nimport { CookieService } from 'ngx-cookie-service';\r\n@Component({\r\n  selector: 'app-sign-in',\r\n  templateUrl: './sign-in.component.html',\r\n  styleUrls: ['./sign-in.component.css']\r\n})\r\nexport class SignInComponent {\r\n\r\n  user: Token | undefined;\r\n\r\n  constructor(\r\n  private store: Store<Auth0.AppState>,\r\n  private auth: Auth0.AuthService,\r\n  private authService: AuthService,\r\n  private router: Router,\r\n  private cookieService: CookieService\r\n  ) {}\r\n  token: string | null = null;\r\n  userEmail: string | null = null;\r\n\r\n  ngOnInit(){\r\n    this.token = this.cookieService.get('userToken');\r\n    this.userEmail = this.cookieService.get('userEmail');\r\n  }\r\n\r\n  Login() {\r\n    this.cookieService.deleteAll();\r\n    this.auth\r\n      .loginWithPopup()\r\n      .pipe(\r\n        take(1),\r\n        switchMap(() => this.auth.user$.pipe(take(1))),\r\n        switchMap((user) => {\r\n          this.cookieService.set('userEmail', user?.email || '');\r\n          return this.authService.login(user?.email).pipe(\r\n            tap((token) => this.cookieService.set('userToken', token)),\r\n            map((token) => ({ user, token }))\r\n          );\r\n        }),\r\n        switchMap(({ user, token }) => \r\n          this.authService.FetchRoles(user?.email).pipe(\r\n            tap((roles) => this.cookieService.set('userType', roles)),\r\n            map((roles) => ({ user, token, roles }))\r\n          )\r\n        )\r\n      ).subscribe({\r\n        next: ({ user, token, roles }) => {\r\n        const googleID: Token = {\r\n          email: user?.email,\r\n          token: token,\r\n          roles: roles\r\n        };\r\n        \r\n        this.store.dispatch(GetLogin({ payload: googleID }));\r\n        this.router.navigateByUrl('/home');\r\n      },\r\n      error:(error) => {\r\n      }\r\n    })\r\n  }\r\n}\r\n","<section class=\"vh-100 gradient-custom\">\r\n  <div class=\"container py-5 h-100\">\r\n    <div class=\"row d-flex justify-content-center align-items-center h-100\">\r\n      <div class=\"col-md-6\">\r\n        <div class=\"card\">\r\n          <form (ngSubmit)=\"Login()\">\r\n            <div class=\"card-header card-header-primary\">\r\n              <h4 class=\"card-title\">Grad Onboarding Platform</h4>\r\n              <p class=\"card-category\">Welcome to the grad program</p>\r\n            </div>\r\n\r\n            <div class=\" card-body d-flex justify-content-center text-center\">\r\n              <p class=\"login-p\" >\r\n                Maybe add some text here.\r\n                I don't know, I'm not a designer.\r\n              </p>\r\n            </div>\r\n\r\n            <div class=\"card-body d-flex justify-content-center text-center\">\r\n              <button type=\"submit\" mat-raised-button class=\"btn btn-primary\">\r\n                Login\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</section>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}